<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ê°€ìœ„ë°”ìœ„ë³´ ì¿ í° ì´ë²¤íŠ¸</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; background:#f6f7f9; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 20px; }
    .card { background:#fff; border-radius:16px; padding:18px; box-shadow: 0 6px 18px rgba(0,0,0,.06); }
    h1 { font-size: 22px; margin: 0 0 8px; }
    .sub { color:#555; margin: 0 0 14px; font-size: 14px; line-height: 1.4; }
    .btns { display:flex; gap:10px; flex-wrap:wrap; margin-top: 12px; }
    button {
      flex: 1 1 30%;
      padding: 14px 10px; border: 0; border-radius: 14px;
      font-size: 18px; cursor: pointer; background:#111; color:#fff;
    }
    button:active { transform: scale(.99); }
    .row { display:flex; gap:12px; margin-top: 14px; flex-wrap:wrap; }
    .box { flex:1 1 220px; padding:14px; border-radius:14px; background:#f2f4f7; }
    .label { font-size: 12px; color:#666; margin-bottom: 6px; }
    .value { font-size: 20px; font-weight: 700; }
    .result { margin-top: 14px; font-size: 18px; font-weight: 800; }
    .hint { margin-top: 10px; font-size: 13px; color:#666; line-height:1.4; }
    .qrWrap { margin-top: 14px; display:none; }
    .qrCard { background:#fff; border-radius:16px; padding:16px; border:1px solid #e6e8ee; }
    .couponLine { margin-top:10px; font-size:14px; color:#333; word-break: break-all; }
    .small { font-size:12px; color:#777; margin-top:8px; line-height:1.4; }
    .footer { margin-top: 14px; font-size: 12px; color:#888; }
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; background:#eef; color:#224; font-size:12px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ê°€ìœ„ë°”ìœ„ë³´ í•œ íŒ ğŸ®</h1>
      <p class="sub">
        ì„ íƒ í›„ ê²°ê³¼ì— ë”°ë¼ <b>ì¿ í° QR</b>ì´ ìƒì„±ë©ë‹ˆë‹¤.<br/>
        <span class="pill">ë¬´ë£Œ ë°ëª¨</span> ìš´ì˜ìš©ìœ¼ë¡œ ë¬¸êµ¬/ì¿ í° ì •ì±…ì€ ììœ ë¡­ê²Œ ë³€ê²½í•˜ì„¸ìš”.
      </p>

      <div class="btns">
        <button onclick="play('ê°€ìœ„')">âœŒï¸ ê°€ìœ„</button>
        <button onclick="play('ë°”ìœ„')">âœŠ ë°”ìœ„</button>
        <button onclick="play('ë³´')">ğŸ–ï¸ ë³´</button>
      </div>

      <div class="row">
        <div class="box">
          <div class="label">ë‚´ ì„ íƒ</div>
          <div class="value" id="me">-</div>
        </div>
        <div class="box">
          <div class="label">ì»´í“¨í„°</div>
          <div class="value" id="cpu">-</div>
        </div>
      </div>

      <div class="result" id="result">ì„ íƒí•´ ì£¼ì„¸ìš”.</div>

      <div class="qrWrap" id="qrWrap">
        <div class="qrCard">
          <div class="label">ì¿ í° QR</div>
          <div id="qrcode"></div>
          <div class="couponLine"><b>ì¿ í° ë‚´ìš©:</b> <span id="couponText">-</span></div>
          <div class="small" id="couponRule">
            * QRì„ ê³„ì‚°ëŒ€ì—ì„œ ì œì‹œí•´ ì£¼ì„¸ìš”. (1íšŒ ì‚¬ìš© / ë‹¹ì¼ ìœ íš¨)
          </div>
        </div>
      </div>

      <div class="hint">
        ìš´ì˜ íŒ(ë¬´ë£Œ ìš´ì˜ ê¸°ì¤€):<br/>
        - â€œê½ ì—†ìŒâ€ ì¶”ì²œ: ë°©ë¬¸ ì „í™˜ì´ í›¨ì”¬ ì¢‹ìŠµë‹ˆë‹¤.<br/>
        - QR ë‚´ìš©ì—ëŠ” <b>ì¿ í°ì¢…ë¥˜ + ë‚ ì§œ + ë‚œìˆ˜</b>ë¥¼ ë„£ì–´ë‘ë©´ í˜„ì¥ í†µì œê°€ ì‰¬ì›Œì§‘ë‹ˆë‹¤.
      </div>

      <div class="footer">
        Â© Event Mini Game
      </div>
    </div>
  </div>

  <!-- QRCode.js (ë¬´ë£Œ CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
  <script>
    const choices = ['ê°€ìœ„','ë°”ìœ„','ë³´'];

    // ìŠ¹/ë¬´/íŒ¨ì— ë”°ë¥¸ ì¿ í° ì •ì±…(ì›í•˜ì‹œë©´ ì—¬ê¸°ë§Œ ë°”ê¾¸ë©´ ë©ë‹ˆë‹¤)
    const couponByOutcome = {
      WIN:  { name: 'ìŒë£Œ 1ì” êµí™˜ê¶Œ',  code: 'DRINK1' },
      DRAW: { name: 'ì‚¬ì´ë“œ 1ì¢… 50% í• ì¸', code: 'SIDE50' },
      LOSE: { name: '5% í• ì¸ ì¿ í°',      code: 'DISC5' }
    };

    // QRì— ë‹´ê¸¸ ë°ì´í„°(í˜„ì¥ í†µì œìš©)
    // ì˜ˆ: INSPIRE|DRINK1|2026-01-07|A1B2C3
    function buildQrPayload(couponCode){
      const d = new Date();
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth()+1).padStart(2,'0');
      const dd = String(d.getDate()).padStart(2,'0');
      const dateStr = `${yyyy}-${mm}-${dd}`;
      const rand = Math.random().toString(16).slice(2, 8).toUpperCase();
      return `INSPIRE|${couponCode}|${dateStr}|${rand}`;
    }

    function judge(me, cpu){
      if(me === cpu) return 'DRAW';
      if(
        (me==='ê°€ìœ„' && cpu==='ë³´') ||
        (me==='ë°”ìœ„' && cpu==='ê°€ìœ„') ||
        (me==='ë³´' && cpu==='ë°”ìœ„')
      ) return 'WIN';
      return 'LOSE';
    }

    let qr; // QRCode instance

    function play(me){
      const cpu = choices[Math.floor(Math.random()*3)];
      document.getElementById('me').textContent = me;
      document.getElementById('cpu').textContent = cpu;

      const outcome = judge(me, cpu);
      const cpn = couponByOutcome[outcome];

      const outcomeText = outcome === 'WIN' ? 'ìŠ¹ë¦¬!' : (outcome === 'DRAW' ? 'ë¬´ìŠ¹ë¶€!' : 'ì•„ì‰½ê²Œ íŒ¨ë°°!');
      document.getElementById('result').textContent = `${outcomeText} ğŸ‘‰ ${cpn.name}`;

      // QR ìƒì„±
      const payload = buildQrPayload(cpn.code);
      document.getElementById('couponText').textContent = payload;
      document.getElementById('qrWrap').style.display = 'block';

      // ê¸°ì¡´ QR ì§€ìš°ê³  ìƒˆë¡œ ìƒì„±
      const el = document.getElementById('qrcode');
      el.innerHTML = '';
      qr = new QRCode(el, {
        text: payload,
        width: 200,
        height: 200,
        correctLevel: QRCode.CorrectLevel.M
      });

      // ìš´ì˜ ë¬¸êµ¬(ì›í•˜ì‹œë©´ ìˆ˜ì •)
      document.getElementById('couponRule').textContent =
        '* QRì„ ê³„ì‚°ëŒ€ì—ì„œ ì œì‹œí•´ ì£¼ì„¸ìš”. (1íšŒ ì‚¬ìš© / ë‹¹ì¼ ìœ íš¨ / ìº¡ì²˜ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ëŠ” ë§¤ì¥ ì •ì±…)';
    }
  </script>
</body>
</html>
